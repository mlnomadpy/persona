function openTab(e){chrome.tabs.query({url:e,currentWindow:!0},(function(t){0===t.length?chrome.tabs.create({url:e,active:!1},(function(t){attachTabUpdateListener(t.id,e)})):attachTabUpdateListener(t[0].id,e)}))}function attachTabUpdateListener(e,t){chrome.tabs.onUpdated.addListener((function r(o,n){o===e&&"complete"===n.status&&(chrome.tabs.onUpdated.removeListener(r),captureTabContent(e,t))}))}function captureTabContent(e,t){chrome.tabs.sendMessage(e,{action:"captureHTML"},(function(r){chrome.runtime.lastError||!r?console.error("Error capturing HTML from",t,":",chrome.runtime.lastError?.message):storeHTML(t,r.html),chrome.tabs.remove(e)}))}function storeHTML(e,t){chrome.storage.local.set({[e]:t},(function(){chrome.runtime.lastError?console.error("Error storing HTML content for",e,":",chrome.runtime.lastError.message):console.log("HTML content stored successfully for",e)}))}chrome.bookmarks.onCreated.addListener((function(e,t){t.url&&openTab(t.url)})),chrome.runtime.onMessage.addListener((function(e,t,r){"storeHTML"===e.action&&(storeHTML(t.tab.url,e.html),r({status:"HTML stored successfully"}))}));